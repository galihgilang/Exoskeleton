%--------------------------------------------------
% kecepatan angular (iR0wi)
R10w1 = R10*(z0*tv1);
R20w2 = R21*((R10w1)+(z0*tv2));
%--------------------------------------------------

%--------------------------------------------------
% percepatan angular (iR0wti)
R10wt1 = R10*(z0*ta1);
R20wt2 = R21*(R10wt1 + (z0*ta2) + cross(R10w1, z0*tv2));
%--------------------------------------------------

%--------------------------------------------------
% percepatan linear (iR0vti)
R10vt1 = cross(R10wt1, R10*p1) + cross(R10w1, cross(R10w1, R10*p1)) + (R10 * g);
R20vt2 = cross(R20wt2, R21*R10*p2) + cross(R20w2, cross(R20w2, R21*R10*p2)) + (R21 * R10vt1);
%--------------------------------------------------

%--------------------------------------------------
% percepatan linear di TPM (iR0ai)
R10a1 = cross(R10wt1, R10*s1) + cross(R10w1, cross(R10w1, R10*s1)) + R10vt1;
R20a2 = cross(R20wt2, R21*R10*s2) + cross(R20w2, cross(R20w2, R21*R10*s2)) + R20vt2;
%--------------------------------------------------

%--------------------------------------------------
% gaya fi (iR0fi)
R20f2 = m2 * R20a2;
R10f1 = R12 * R20f2 + (m1 * R10a1);
%--------------------------------------------------

%--------------------------------------------------
% gaya ni (iR0ni)
R20n2 = cross(((R21*R10*p2) + (R21*R10*s2)), m2*R20a2) + (R20I2R02 * R20wt2);
R10n1 = (R12 * (R20n2 + cross(R21*R10*p1, R20f2))) + cross(((R10*p1) + (R10*s1)), m1*R10a1) + (R10I1R01 * R10wt1);
%--------------------------------------------------

%--------------------------------------------------
% torque (to1)
to1 = transpose(R10n1) * (R10*z0) + b1*tv1;
to2 = transpose(R20n2) * (R21*z0) + b2*tv2;
%--------------------------------------------------